import{_ as a,c as s,o as i,V as d}from"./chunks/framework.jgiY9GFO.js";const g=JSON.parse('{"title":"P_3038_USACO_11_DEC_Grass_Planting_G","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/2024-03-08/P_3038_USACO_11_DEC_Grass_Planting_G.md","filePath":"cpp/2024-03-08/P_3038_USACO_11_DEC_Grass_Planting_G.md"}'),t={name:"cpp/2024-03-08/P_3038_USACO_11_DEC_Grass_Planting_G.md"},n=d(`<h1 id="p-3038-usaco-11-dec-grass-planting-g" tabindex="-1" data-v-ca581a4d>P_3038_USACO_11_DEC_Grass_Planting_G <a class="header-anchor" href="#p-3038-usaco-11-dec-grass-planting-g" aria-label="Permalink to &quot;P_3038_USACO_11_DEC_Grass_Planting_G&quot;" data-v-ca581a4d>â€‹</a></h1><div class="language-cpp vp-adaptive-theme" data-v-ca581a4d><button title="Copy Code" class="copy" data-v-ca581a4d></button><span class="lang" data-v-ca581a4d>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-ca581a4d><code data-v-ca581a4d><span class="line" data-v-ca581a4d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-ca581a4d>// #include&lt;bits/stdc++.h&gt;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &lt;iostream&gt;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &lt;algorithm&gt;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &lt;cstring&gt;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &lt;queue&gt;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &lt;vector&gt;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> long</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>typedef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> pair</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> PII;</span></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> LOCAL_MACHINE</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(format, ##arg)</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, ...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>[1m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>[45;33m Info:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>)]: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>[0m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> format </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>__FILE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>__FUNCTION__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>__LINE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, ##__VA_ARGS__);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#else</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>...);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, ...)</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#endif</span></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> zassert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d>s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>\\</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>	do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> ((x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>%s\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, s); </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>((x)); } } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>)</span></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 101000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> n, m, a[N], b[N];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-ca581a4d>//</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> edge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> {</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> to, next;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>} e[N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> head[N];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> idx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    e[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>idx] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (edge){v, head[u]};</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    head[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> idx;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-ca581a4d>//</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> size[N], top[N], son[N], fa[N], deep[N], id[N], idx;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> father</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    deep[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> deep[father] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    size[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    fa[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> father;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> head[u];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> e[i].next){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> e[i].to;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> father) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(v, u);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        size[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> size[v];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(size[son[u]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> size[v]) son[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    id[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d> ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>idx;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    top[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> t;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>son[u]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(son[u], t);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> head[u];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> e[i].next){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> e[i].to;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(fa[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> son[u]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(v, v);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>{</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> l,r;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    ll sum, add;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>} tree[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>N];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> lson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> rson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> pushup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[k].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[lson].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[rson].sum;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>tree[k].add) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[lson].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (tree[lson].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[lson].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[rson].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (tree[rson].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[rson].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[lson].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].add;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[rson].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].add;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> l;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    tree[k].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> r;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> r){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        tree[k].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> r) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(k);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(lson, l, mid);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(rson, mid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, r);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    pushup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(k);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>ll</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].r){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].sum;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    ll ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].r) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(k);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid) ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(lson, l, r);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid) ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(rson, l , r);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> ans;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>ll</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> queryRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    ll ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> top[y]){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(deep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> deep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(x, y);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, id[top[x]], id[x]);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> fa[top[x]];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> id[y]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(x, y);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, id[y]);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> ans;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].r){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        tree[k].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (tree[k].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> val;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> val;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> (tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> tree[k].r) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(k);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(lson, l, r, val);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> mid) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(rson, l, r, val);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    pushup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(k);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> addRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-ca581a4d> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> top[y]){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(deep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> deep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(x, y);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>        update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, id[top[x]], id[x], val);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> fa[top[x]];</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(deep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> deep[y]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(x, y);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>, id[y], val);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> m;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> n;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> u,v; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(u,v);</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(v,u);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,n);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> op; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> op;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> u,v; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> v;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(op </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &#39;P&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>            addRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(u, v, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(op </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-ca581a4d> &#39;Q&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>            cout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> queryRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(u, v) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> endl;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>        }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span>
<span class="line" data-v-ca581a4d></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>    ios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>sync_with_stdio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    cin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);cout.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>);</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-ca581a4d>    // cin &gt;&gt; n;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>){</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-ca581a4d>        solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>();</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>    }</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-ca581a4d>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-ca581a4d> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>;</span></span>
<span class="line" data-v-ca581a4d><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-ca581a4d>}</span></span></code></pre></div>`,2),h=[n];function k(l,p,E,e,c,v){return i(),s("div",null,h)}const y=a(t,[["render",k],["__scopeId","data-v-ca581a4d"]]);export{g as __pageData,y as default};

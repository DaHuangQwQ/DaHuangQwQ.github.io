import{_ as a,c as s,o as i,V as t}from"./chunks/framework.jgiY9GFO.js";const g=JSON.parse('{"title":"P_4427_BJOI_2018_求和","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/1984-01-24/P_4427_BJOI_2018_求和.md","filePath":"cpp/1984-01-24/P_4427_BJOI_2018_求和.md"}'),d={name:"cpp/1984-01-24/P_4427_BJOI_2018_求和.md"},n=t(`<h1 id="p-4427-bjoi-2018-求和" tabindex="-1" data-v-2d1f8393>P_4427_BJOI_2018_求和 <a class="header-anchor" href="#p-4427-bjoi-2018-求和" aria-label="Permalink to &quot;P_4427_BJOI_2018_求和&quot;" data-v-2d1f8393>​</a></h1><div class="language-cpp vp-adaptive-theme" data-v-2d1f8393><button title="Copy Code" class="copy" data-v-2d1f8393></button><span class="lang" data-v-2d1f8393>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-2d1f8393><code data-v-2d1f8393><span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-2d1f8393> &lt;iostream&gt;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-2d1f8393> &lt;algorithm&gt;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-2d1f8393> &lt;cstring&gt;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> long</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> MOD</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 998244353</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 300000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> n,m, st[N][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>51</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>], res;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>{</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> next,to;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>} e[N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>];</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> head[N], idx;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    e[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>idx].to </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> v;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    e[idx].next </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> head[u];</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    head[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> idx;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>}</span></span>
<span class="line" data-v-2d1f8393></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>inline</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> power</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(t){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>) res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> (ll)res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>MOD;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> (ll)a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>MOD;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> res;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>}</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-2d1f8393>//</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> fa[N],son[N],siz[N],dep[N],id[N],top[N],tot;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> father</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    siz[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    dep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> dep[father] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    fa[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> father;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        st[x][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> st[father][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>+</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> power</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(dep[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>,i);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        st[x][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>%=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> MOD;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> head[x];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> e[i].next){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> e[i].to;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> father) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(y, x);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        siz[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> siz[y];</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(siz[son[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> siz[y]) son[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> y;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>}</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> k;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>tot;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>son[x]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(son[x], k);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> head[x];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> e[i].next){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> e[i].to;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> son[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> fa[x]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(y,y);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>}</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> lca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-2d1f8393> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> top[y]){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(dep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> dep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(x, y);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> fa[top[x]];</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(dep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> dep[y]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> x;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> y;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>}</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> n;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>,u,v;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> n;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> v;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(u,v);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(v,u);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> m;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>){</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> u,v,k; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> k;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-2d1f8393> lca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>(u, v);</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-2d1f8393>        // cout &lt;&lt; st[4][k] &lt;&lt; endl;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> (st[u][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> st[v][k]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> MOD;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>-=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> (st[f][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> st[fa[f]][k]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> MOD;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> (res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> MOD) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> MOD;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>        cout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393> endl;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>    }</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-2d1f8393>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-2d1f8393> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>;</span></span>
<span class="line" data-v-2d1f8393><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-2d1f8393>}</span></span></code></pre></div>`,2),h=[n];function k(l,p,E,e,f,v){return i(),s("div",null,h)}const y=a(d,[["render",k],["__scopeId","data-v-2d1f8393"]]);export{g as __pageData,y as default};

import{_ as a,c as s,o as i,V as t}from"./chunks/framework.jgiY9GFO.js";const r=JSON.parse('{"title":"P_4427_BJOI_2018_求和","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/1984-01/P_4427_BJOI_2018_求和.md","filePath":"cpp/1984-01/P_4427_BJOI_2018_求和.md"}'),d={name:"cpp/1984-01/P_4427_BJOI_2018_求和.md"},n=t(`<h1 id="p-4427-bjoi-2018-求和" tabindex="-1" data-v-d524f8bf>P_4427_BJOI_2018_求和 <a class="header-anchor" href="#p-4427-bjoi-2018-求和" aria-label="Permalink to &quot;P_4427_BJOI_2018_求和&quot;" data-v-d524f8bf>​</a></h1><div class="language-cpp vp-adaptive-theme" data-v-d524f8bf><button title="Copy Code" class="copy" data-v-d524f8bf></button><span class="lang" data-v-d524f8bf>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-d524f8bf><code data-v-d524f8bf><span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-d524f8bf> &lt;iostream&gt;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-d524f8bf> &lt;algorithm&gt;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-d524f8bf> &lt;cstring&gt;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> long</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> MOD</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 998244353</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 300000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> n,m, st[N][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>51</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>], res;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>{</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> next,to;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>} e[N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>];</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> head[N], idx;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    e[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>idx].to </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> v;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    e[idx].next </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> head[u];</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    head[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> idx;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>}</span></span>
<span class="line" data-v-d524f8bf></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>inline</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> power</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(t){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>) res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> (ll)res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>MOD;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> (ll)a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>MOD;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> res;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>}</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-d524f8bf>//</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> fa[N],son[N],siz[N],dep[N],id[N],top[N],tot;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> father</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    siz[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    dep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> dep[father] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    fa[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> father;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        st[x][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> st[father][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>+</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> power</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(dep[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>,i);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        st[x][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>%=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> MOD;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> head[x];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> e[i].next){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> e[i].to;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> father) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(y, x);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        siz[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> siz[y];</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(siz[son[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> siz[y]) son[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> y;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>}</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> k;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>tot;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>son[x]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(son[x], k);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> head[x];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> e[i].next){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> e[i].to;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> son[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> fa[x]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(y,y);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>}</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> lca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d524f8bf> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> top[y]){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(dep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> dep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(x, y);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> fa[top[x]];</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(dep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> dep[y]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> x;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> y;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>}</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> n;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>,u,v;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> n;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> v;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(u,v);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(v,u);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> m;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>){</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> u,v,k; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> k;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d524f8bf> lca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>(u, v);</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-d524f8bf>        // cout &lt;&lt; st[4][k] &lt;&lt; endl;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> (st[u][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> st[v][k]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> MOD;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>-=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> (st[f][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> st[fa[f]][k]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> MOD;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> (res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> MOD) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> MOD;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>        cout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf> endl;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>    }</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d524f8bf>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d524f8bf> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>;</span></span>
<span class="line" data-v-d524f8bf><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d524f8bf>}</span></span></code></pre></div>`,2),h=[n];function k(l,f,p,E,e,v){return i(),s("div",null,h)}const g=a(d,[["render",k],["__scopeId","data-v-d524f8bf"]]);export{r as __pageData,g as default};

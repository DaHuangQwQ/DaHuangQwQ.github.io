import{_ as s,c as i,a2 as t,o as n}from"./chunks/framework.BQmytedh.js";const v=JSON.parse('{"title":"P_3038_USACO_11_DEC_Grass_Planting_G","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/2024-03/P_3038_USACO_11_DEC_Grass_Planting_G.md","filePath":"cpp/2024-03/P_3038_USACO_11_DEC_Grass_Planting_G.md"}'),k={name:"cpp/2024-03/P_3038_USACO_11_DEC_Grass_Planting_G.md"};function h(e,a,l,p,d,E){return n(),i("div",null,a[0]||(a[0]=[t(`<h1 id="p-3038-usaco-11-dec-grass-planting-g" tabindex="-1" data-v-11e407c7>P_3038_USACO_11_DEC_Grass_Planting_G <a class="header-anchor" href="#p-3038-usaco-11-dec-grass-planting-g" aria-label="Permalink to &quot;P_3038_USACO_11_DEC_Grass_Planting_G&quot;" data-v-11e407c7>â€‹</a></h1><div class="language-cpp vp-adaptive-theme" data-v-11e407c7><button title="Copy Code" class="copy" data-v-11e407c7></button><span class="lang" data-v-11e407c7>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" data-v-11e407c7><code data-v-11e407c7><span class="line" data-v-11e407c7><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-11e407c7>// #include&lt;bits/stdc++.h&gt;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &lt;iostream&gt;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &lt;algorithm&gt;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &lt;cstring&gt;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &lt;queue&gt;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &lt;vector&gt;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> long</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>typedef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> pair</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> PII;</span></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> LOCAL_MACHINE</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(format, ##arg)</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, ...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>[1m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>[45;33m Info:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>)]: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>[0m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> format </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>__FILE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>__FUNCTION__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>__LINE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, ##__VA_ARGS__);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#else</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>...);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, ...)</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#endif</span></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> zassert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7>s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>\\</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>	do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> ((x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>%s\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, s); </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>((x)); } } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>)</span></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 101000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> n, m, a[N], b[N];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-11e407c7>//</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> edge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> {</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> to, next;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>} e[N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> head[N];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> idx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    e[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>idx] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (edge){v, head[u]};</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    head[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> idx;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-11e407c7>//</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> size[N], top[N], son[N], fa[N], deep[N], id[N], idx;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> father</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    deep[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> deep[father] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    size[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    fa[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> father;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> head[u];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> e[i].next){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> e[i].to;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> father) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(v, u);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        size[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> size[v];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(size[son[u]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> size[v]) son[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    id[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7> ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>idx;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    top[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> t;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>son[u]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(son[u], t);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> head[u];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> e[i].next){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> e[i].to;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(fa[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> son[u]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(v, v);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>{</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> l,r;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    ll sum, add;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>} tree[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>N];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> lson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> rson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> pushup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[k].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[lson].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[rson].sum;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>tree[k].add) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[lson].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (tree[lson].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[lson].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[rson].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (tree[rson].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[rson].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[lson].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].add;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[rson].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].add;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> l;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    tree[k].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> r;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> r){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        tree[k].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> r) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(k);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(lson, l, mid);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(rson, mid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, r);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    pushup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(k);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>ll</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].r){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].sum;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    ll ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].r) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(k);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid) ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(lson, l, r);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid) ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(rson, l , r);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> ans;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>ll</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> queryRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    ll ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> top[y]){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(deep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> deep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(x, y);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, id[top[x]], id[x]);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> fa[top[x]];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> id[y]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(x, y);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    ans </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, id[y]);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> ans;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].r){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        tree[k].sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (tree[k].r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> val;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        tree[k].add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> val;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> (tree[k].l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> tree[k].r) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    pushdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(k);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(lson, l, r, val);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> mid) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(rson, l, r, val);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    pushup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(k);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> addRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-11e407c7> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> top[y]){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(deep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> deep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(x, y);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>        update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, id[top[x]], id[x], val);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> fa[top[x]];</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(deep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> deep[y]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(x, y);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>, id[y], val);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> m;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> n;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> u,v; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(u,v);</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(v,u);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,n);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> op; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> op;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> u,v; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> v;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(op </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &#39;P&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>            addRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(u, v, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(op </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-11e407c7> &#39;Q&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>            cout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> queryRoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(u, v) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> endl;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>        }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span>
<span class="line" data-v-11e407c7></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>    ios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>sync_with_stdio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    cin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);cout.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>);</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-11e407c7>    // cin &gt;&gt; n;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>){</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-11e407c7>        solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>();</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>    }</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-11e407c7>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-11e407c7> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>;</span></span>
<span class="line" data-v-11e407c7><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-11e407c7>}</span></span></code></pre></div>`,2)]))}const r=s(k,[["render",h],["__scopeId","data-v-11e407c7"]]);export{v as __pageData,r as default};

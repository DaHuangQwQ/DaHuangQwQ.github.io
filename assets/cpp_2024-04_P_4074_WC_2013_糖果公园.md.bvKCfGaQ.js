import{_ as a,c as s,o as i,V as t}from"./chunks/framework.WykxUCM3.js";const y=JSON.parse('{"title":"P_4074_WC_2013_糖果公园","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/2024-04/P_4074_WC_2013_糖果公园.md","filePath":"cpp/2024-04/P_4074_WC_2013_糖果公园.md"}'),h={name:"cpp/2024-04/P_4074_WC_2013_糖果公园.md"},n=t(`<h1 id="p-4074-wc-2013-糖果公园" tabindex="-1" data-v-67194633>P_4074_WC_2013_糖果公园 <a class="header-anchor" href="#p-4074-wc-2013-糖果公园" aria-label="Permalink to &quot;P_4074_WC_2013_糖果公园&quot;" data-v-67194633>​</a></h1><div class="language-cpp vp-adaptive-theme" data-v-67194633><button title="Copy Code" class="copy" data-v-67194633></button><span class="lang" data-v-67194633>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-67194633><code data-v-67194633><span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> ONLINE_JUDGE</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&lt;bits/stdc++.h&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#else</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;iostream&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;stdio.h&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;assert.h&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;algorithm&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;cstring&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;queue&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &lt;vector&gt;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#endif</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> long</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> endl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> INF</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>9</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>typedef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> pair</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> PII;</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> LOCAL_MACHINE</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(format, ##arg)</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, ...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>[1m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>[45;33m Info:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>)]: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>[0m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> format </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>__FILE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>__FUNCTION__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>__LINE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, ##__VA_ARGS__);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#else</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>...);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, ...)</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#endif</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> zassert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>\\</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>	do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> ((x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%s\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>, s); </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>((x)); } } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>)</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>// </span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> head[N],to[N],ne[N],idx;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //连边</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>  to[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>idx]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>v;ne[idx]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>head[u];head[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>idx;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> fa[N],son[N],siz[N],dep[N],top[N];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> tim,in[N],out[N],a[N</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //树链剖分</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    fa[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>f;siz[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;dep[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>dep[f]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>head[u];i;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>ne[i]){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>to[i];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>f) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(v,u);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        siz[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>siz[v];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(siz[son[u]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>siz[v])son[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>v;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    in[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tim;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //进u时刻</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    a[tim]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>u;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    //括号序</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    top[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>t;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(son[u]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(son[u],t);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>head[u];i;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>ne[i]){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>to[i];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>fa[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>son[u])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(v,v);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    out[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tim;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //出u时刻</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    a[tim]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>u;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>     //括号序  </span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> LCA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(top[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>top[v]){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(dep[top[u]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>dep[top[v]])</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(u,v);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>fa[top[u]];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> dep[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>dep[v]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>v;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> n,m,k,B,tot,V[N],W[N],C[N];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> pos[N],newC[N],vis[N],cnt[N];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>ll ans[N],sum;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> Q</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>{</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> l,r,t,id,lca;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> operator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> Q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633> &amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633>b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> {</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>b.l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>B)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>b.l;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>b.r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>B)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>b.r;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>b.t;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}q[N];</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-67194633> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    vis[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>^=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>  //访问x点的次数</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    // 一次扩展 加上贡献，两次扩展 减去贡献</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(vis[x]) sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>ll*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>W[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>cnt[C[x]]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>V[C[x]];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>       sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>-=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>ll*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>W[cnt[C[x]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>V[C[x]];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>    scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d%d%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>n,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>m,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>k);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //点,糖果种类,操作</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>m;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>V[i]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>//美味</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>n;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>W[i]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>//新奇</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,u,v;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>n;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //连边</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>        scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>u,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>v),</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(u,v),</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(v,u);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    // 预处理括号序和LCA</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>n;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>C[i]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>//糖果类型</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    // 预处理操作</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,Type,x,y;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>k;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>        scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%d%d%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>Type,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>x,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>y); </span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //区查</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> lca</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>LCA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(x,y);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        q[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tot].t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>t;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        q[tot].id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tot; </span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(in[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>in[y])</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(x,y);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //先x后y</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(lca</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>x){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //直链情况</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            q[tot].l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>in[x];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            q[tot].r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>in[y];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>{</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //折链情况</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            q[tot].l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>out[x];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            q[tot].r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>in[y];</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            q[tot].lca</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>lca;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //以便补偿</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>{</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //点修</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        pos[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>t]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>x;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //位置</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        newC[t]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>y;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>  //修改值</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    // 树上带修莫队</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>pow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>n,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0.66</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>    sort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>q[i].l)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(a[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>l]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>q[i].r)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(a[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>r]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>q[i].l)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(a[l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>q[i].r)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(a[r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>q[i].t){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //时间戳变大则替换</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>            ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>t;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(vis[pos[t]]){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(pos[t]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>                swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(C[pos[t]],newC[t]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //换成修改值</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(pos[t]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>            else</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(C[pos[t]],newC[t]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        }    </span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>q[i].t){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //时间戳变小则还原</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(vis[pos[t]]){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(pos[t]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>                swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(C[pos[t]],newC[t]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> //还原修改值</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(pos[t]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>            else</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(C[pos[t]],newC[t]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>            t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        }</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>        ans[q[i].id]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>sum;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(q[i].lca) ans[q[i].id]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>ll*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>W[cnt[C[q[i].lca]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>V[C[q[i].lca]];</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633> // 补偿上 lca</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>    }   </span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>tot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>%lld\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-67194633>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>,ans[i]);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span>
<span class="line" data-v-67194633></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>signed</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(){</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    #ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633> ONLINE_JUDGE</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    // freopen(&quot;&quot;, &quot;r&quot;, stdin);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    #endif</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>    ios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>sync_with_stdio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);cin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);cout.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>);</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-67194633>    // cin &gt;&gt; n;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>){</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-67194633>solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>();}</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-67194633>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-67194633> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>;</span></span>
<span class="line" data-v-67194633><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-67194633>}</span></span></code></pre></div>`,2),k=[n];function l(p,d,E,e,v,r){return i(),s("div",null,k)}const F=a(h,[["render",l],["__scopeId","data-v-67194633"]]);export{y as __pageData,F as default};

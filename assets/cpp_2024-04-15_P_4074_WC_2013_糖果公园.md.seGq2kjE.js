import{_ as a,c as s,o as i,V as t}from"./chunks/framework.jgiY9GFO.js";const g=JSON.parse('{"title":"P_4074_WC_2013_糖果公园","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/2024-04-15/P_4074_WC_2013_糖果公园.md","filePath":"cpp/2024-04-15/P_4074_WC_2013_糖果公园.md"}'),h={name:"cpp/2024-04-15/P_4074_WC_2013_糖果公园.md"},n=t(`<h1 id="p-4074-wc-2013-糖果公园" tabindex="-1" data-v-382548eb>P_4074_WC_2013_糖果公园 <a class="header-anchor" href="#p-4074-wc-2013-糖果公园" aria-label="Permalink to &quot;P_4074_WC_2013_糖果公园&quot;" data-v-382548eb>​</a></h1><div class="language-cpp vp-adaptive-theme" data-v-382548eb><button title="Copy Code" class="copy" data-v-382548eb></button><span class="lang" data-v-382548eb>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-v-382548eb><code data-v-382548eb><span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> ONLINE_JUDGE</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&lt;bits/stdc++.h&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#else</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;iostream&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;stdio.h&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;assert.h&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;algorithm&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;cstring&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;queue&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &lt;vector&gt;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#endif</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> long</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> endl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> INF</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>9</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>typedef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> pair</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> PII;</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> LOCAL_MACHINE</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(format, ##arg)</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, ...) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>[1m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>[45;33m Info:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>)]: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>\\033</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>[0m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> format </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>__FILE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>__FUNCTION__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>__LINE__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, ##__VA_ARGS__);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#else</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>...);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>	#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> debug_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, ...)</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#endif</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> zassert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>\\</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>	do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> ((x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>) { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%s\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>, s); </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>((x)); } } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>)</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>// </span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> head[N],to[N],ne[N],idx;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //连边</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>  to[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>idx]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>v;ne[idx]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>head[u];head[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>idx;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> fa[N],son[N],siz[N],dep[N],top[N];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> tim,in[N],out[N],a[N</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //树链剖分</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    fa[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>f;siz[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;dep[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>dep[f]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>head[u];i;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>ne[i]){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>to[i];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>f) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(v,u);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        siz[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>siz[v];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(siz[son[u]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>siz[v])son[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>v;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    in[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tim;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //进u时刻</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    a[tim]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>u;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    //括号序</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    top[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>t;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(son[u]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(son[u],t);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>head[u];i;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>ne[i]){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>to[i];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>fa[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>son[u])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(v,v);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    out[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tim;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //出u时刻</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    a[tim]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>u;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>     //括号序  </span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> LCA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(top[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>top[v]){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(dep[top[u]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>dep[top[v]])</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(u,v);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>fa[top[u]];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> dep[u]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>dep[v]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>v;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> n,m,k,B,tot,V[N],W[N],C[N];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> pos[N],newC[N],vis[N],cnt[N];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>ll ans[N],sum;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> Q</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>{</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> l,r,t,id,lca;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> operator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> Q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb> &amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb>b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> {</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>b.l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>B)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>b.l;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>b.r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>B)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>b.r;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>b.t;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}q[N];</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-382548eb> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    vis[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>^=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>  //访问x点的次数</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    // 一次扩展 加上贡献，两次扩展 减去贡献</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(vis[x]) sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>ll*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>W[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>cnt[C[x]]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>V[C[x]];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>       sum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>-=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>ll*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>W[cnt[C[x]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>V[C[x]];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>    scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d%d%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>n,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>m,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>k);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //点,糖果种类,操作</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>m;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>V[i]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>//美味</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>n;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>W[i]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>//新奇</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,u,v;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>n;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //连边</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>        scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>u,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>v),</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(u,v),</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>link</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(v,u);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    // 预处理括号序和LCA</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>n;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>C[i]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>//糖果类型</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    // 预处理操作</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,Type,x,y;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>k;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>        scanf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%d%d%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>Type,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>x,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>y); </span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //区查</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> lca</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>LCA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(x,y);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        q[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tot].t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>t;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        q[tot].id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tot; </span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(in[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>in[y])</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(x,y);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //先x后y</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(lca</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>x){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //直链情况</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            q[tot].l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>in[x];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            q[tot].r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>in[y];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>{</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //折链情况</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            q[tot].l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>out[x];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            q[tot].r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>in[y];</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            q[tot].lca</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>lca;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //以便补偿</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>{</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //点修</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        pos[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>t]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>x;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //位置</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        newC[t]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>y;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>  //修改值</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    // 树上带修莫队</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>pow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>n,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0.66</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>    sort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>q[i].l)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(a[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>l]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>q[i].r)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(a[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>r]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>q[i].l)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(a[l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>q[i].r)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(a[r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>q[i].t){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //时间戳变大则替换</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>            ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>t;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(vis[pos[t]]){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(pos[t]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>                swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(C[pos[t]],newC[t]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //换成修改值</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(pos[t]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>            else</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(C[pos[t]],newC[t]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        }    </span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>q[i].t){</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //时间戳变小则还原</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(vis[pos[t]]){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(pos[t]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>                swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(C[pos[t]],newC[t]);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> //还原修改值</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>                add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(pos[t]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>            else</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(C[pos[t]],newC[t]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>            t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        }</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>        ans[q[i].id]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>sum;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(q[i].lca) ans[q[i].id]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>ll*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>W[cnt[C[q[i].lca]]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>V[C[q[i].lca]];</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb> // 补偿上 lca</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>    }   </span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>tot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>i)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>%lld\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-382548eb>&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>,ans[i]);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span>
<span class="line" data-v-382548eb></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>signed</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(){</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    #ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb> ONLINE_JUDGE</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    // freopen(&quot;&quot;, &quot;r&quot;, stdin);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    #endif</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>    ios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>sync_with_stdio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);cin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);cout.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>tie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>);</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-382548eb>    // cin &gt;&gt; n;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>(n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>){</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-382548eb>solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>();}</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-382548eb>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-382548eb> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>;</span></span>
<span class="line" data-v-382548eb><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-382548eb>}</span></span></code></pre></div>`,2),k=[n];function e(l,p,d,E,v,b){return i(),s("div",null,k)}const y=a(h,[["render",e],["__scopeId","data-v-382548eb"]]);export{g as __pageData,y as default};

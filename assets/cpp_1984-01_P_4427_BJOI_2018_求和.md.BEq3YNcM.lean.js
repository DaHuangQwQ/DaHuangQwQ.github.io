import{_ as s,c as i,a2 as t,o as d}from"./chunks/framework.BQmytedh.js";const v=JSON.parse('{"title":"P_4427_BJOI_2018_求和","description":"","frontmatter":{},"headers":[],"relativePath":"cpp/1984-01/P_4427_BJOI_2018_求和.md","filePath":"cpp/1984-01/P_4427_BJOI_2018_求和.md"}'),n={name:"cpp/1984-01/P_4427_BJOI_2018_求和.md"};function h(k,a,e,l,p,E){return d(),i("div",null,a[0]||(a[0]=[t(`<h1 id="p-4427-bjoi-2018-求和" tabindex="-1" data-v-d5e5489f>P_4427_BJOI_2018_求和 <a class="header-anchor" href="#p-4427-bjoi-2018-求和" aria-label="Permalink to &quot;P_4427_BJOI_2018_求和&quot;" data-v-d5e5489f>​</a></h1><div class="language-cpp vp-adaptive-theme" data-v-d5e5489f><button title="Copy Code" class="copy" data-v-d5e5489f></button><span class="lang" data-v-d5e5489f>cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" data-v-d5e5489f><code data-v-d5e5489f><span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-d5e5489f> &lt;iostream&gt;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-d5e5489f> &lt;algorithm&gt;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;" data-v-d5e5489f> &lt;cstring&gt;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> ll</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> long</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> MOD</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 998244353</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>using</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 300000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> n,m, st[N][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>51</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>], res;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>{</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> next,to;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>} e[N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>];</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> head[N], idx;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    e[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>idx].to </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> v;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    e[idx].next </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> head[u];</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    head[u] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> idx;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>}</span></span>
<span class="line" data-v-d5e5489f></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>inline</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> power</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(t){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>) res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> (ll)res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>MOD;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> (ll)a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>MOD;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> res;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>}</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-d5e5489f>//</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> fa[N],son[N],siz[N],dep[N],id[N],top[N],tot;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> father</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    siz[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    dep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> dep[father] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    fa[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> father;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        st[x][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> st[father][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>+</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> power</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(dep[x]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>,i);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        st[x][i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>%=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> MOD;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> head[x];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> e[i].next){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> e[i].to;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> father) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>        dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(y, x);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        siz[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> siz[y];</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(siz[son[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> siz[y]) son[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> y;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>}</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> k;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    id[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>tot;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>son[x]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(son[x], k);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> head[x];i;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> e[i].next){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> e[i].to;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> son[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> fa[x]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>        dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(y,y);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>}</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> lca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;" data-v-d5e5489f> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(top[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> top[y]){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(dep[top[x]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> dep[top[y]]) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(x, y);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> fa[top[x]];</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(dep[x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> dep[y]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> x;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> y;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>}</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> n;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>,u,v;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> n;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> v;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(u,v);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>        add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(v,u);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>    dfs1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f>    dfs2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f>1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> m;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>){</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> u,v,k; cin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> k;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>        int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;" data-v-d5e5489f> lca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>(u, v);</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;" data-v-d5e5489f>        // cout &lt;&lt; st[4][k] &lt;&lt; endl;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> (st[u][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> st[v][k]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> MOD;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>-=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> (st[f][k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> st[fa[f]][k]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> MOD;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> (res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> MOD) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> MOD;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>        cout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>&lt;&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f> endl;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>    }</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;" data-v-d5e5489f>    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;" data-v-d5e5489f> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>;</span></span>
<span class="line" data-v-d5e5489f><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;" data-v-d5e5489f>}</span></span></code></pre></div>`,2)]))}const r=s(n,[["render",h],["__scopeId","data-v-d5e5489f"]]);export{v as __pageData,r as default};

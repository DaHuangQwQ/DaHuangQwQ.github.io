# 负载均衡

## 种类

1. 轮询、随机 

   >  有俩个假设 所有服务器的处理能力是一样的，所有请求所需的资源也是一样的

2. 加权轮询、加权随机

   > 权重通过注册中心传递

3. 哈希、加权哈希、一致性哈希

4. 动态负载均衡算法（99%不会用）
   - 最小连接数 连接多路复用 连接数不准
   - 最小活跃数 正在处理的请求 请求大小不一样 不太好用
   - 最快响应时间算法 平均响应时间 99线 999线

   >  微服务框架不具备全局信息
   >
   >  要有阈值 最小不能为负数， 最大不能超过哪个值
   
5. 设计自己的负载均衡算法

   > 信心通过服务端响应头携带自己的元数据指标、利用可观测平台，最高端的做法是前俩个和在一起使用

## FailOver 机制

### 重试



## 本地缓存负载均衡 redis缓存负载均衡策略

哈希类负载均衡能解决这样的问题

同一个key必然命中同一个节点

显著提高缓存命中率 和 提高内存利用率

如果额外添加了一个节点 缓存命中率 骤然下降

所以用一致性哈希



